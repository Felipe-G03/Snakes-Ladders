{% extends "game/base.html" %}
{% block title %}Multiplayer — Lobby{% endblock %}

{% block extra_head %}
<style>
  .lobby-grid {
    display: grid;
    grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.1fr);
    gap: 1rem;
    align-items: flex-start;
  }
  .lobby-col {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  @media (max-width: 900px) {
    .lobby-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
{% endblock %}

{% block content %}
<main>
  <h1 class="titulo">Lobby Multiplayer</h1>

  <div class="lobby-grid">
    <!-- Coluna esquerda: criar sala + como funciona -->
    <div class="lobby-col">
      <section class="cartao">
        <h2>Criar sala</h2>
        <p>Crie uma nova sala, defina o tamanho do tabuleiro e convide amigos.</p>
        <form method="post" action="{% url 'game:multiplayer_create' %}" class="formulario">
          {% csrf_token %}
          <button class="btn btn-primario" type="submit">Criar sala</button>
        </form>
      </section>

      <section class="cartao">
        <h2>Como funciona?</h2>
        <ul class="eventos">
          <li>Crie a sala, ajuste as configurações (pública/privada, tamanho do tabuleiro).</li>
          <li>Convide amigos ou deixe pública para outros entrarem.</li>
          <li>Quando iniciar, todos veem o mesmo tabuleiro e jogam por turnos.</li>
        </ul>
      </section>
    </div>

    <!-- Coluna direita: entrar por código + salas públicas -->
    <div class="lobby-col">
      <section class="cartao">
        <h2>Entrar em sala</h2>
        <p>Digite o código da sala que você recebeu de um amigo.</p>
        <form method="post" action="{% url 'game:multiplayer_join' %}" class="formulario">
          {% csrf_token %}
          <label class="campo">
            <span>Código da sala</span>
            <input
              type="text"
              name="code"
              placeholder="Ex: ABC123"
              maxlength="8"
              required
              style="text-transform:uppercase;"
            >
          </label>
          <button class="btn btn-primario" type="submit">Entrar</button>
        </form>
      </section>

      <section class="cartao">
        <h2>Salas públicas</h2>
        <p>Entre em uma sala pública que está aguardando jogadores.</p>
        <ul class="eventos">
          {% for room in public_rooms %}
            <li>
              <strong>Código:</strong> {{ room.code }} —
              <strong>Host:</strong> {{ room.host.username }} —
              <strong>Jogadores:</strong> {{ room.players.count }}
              <form
                method="post"
                action="{% url 'game:multiplayer_join' %}"
                style="display:inline-block; margin-left:.5rem;"
              >
                {% csrf_token %}
                <input type="hidden" name="code" value="{{ room.code }}">
                <button class="btn btn-primario" type="submit">Entrar</button>
              </form>
            </li>
          {% empty %}
            <li class="muted">Nenhuma sala pública no momento.</li>
          {% endfor %}
        </ul>
      </section>
    </div>
  </div>
</main>
{% endblock %}
